SELECT 
    NVL(f.CODTERM, 'SIN CODIGO') AS CODPROD,
    NVL(RPAD(LTRIM(RTRIM(f.NOMTERM)), 50, '.') || ' ==> ' || f.CODTERM, 'SIN DESCRIPCION') AS NOMPROD,
    0 AS UBICACION, 
    'VENTAS_PRODUCCION' AS tipo, 
    NVL(SUM(CASE WHEN v.ANOMES = '202301' THEN v.VALOR ELSE 0 END), 0) AS "202301",
    NVL(SUM(CASE WHEN v.ANOMES = '202302' THEN v.VALOR ELSE 0 END), 0) AS "202302",
    NVL(SUM(CASE WHEN v.ANOMES = '202303' THEN v.VALOR ELSE 0 END), 0) AS "202303",
    NVL(SUM(CASE WHEN v.ANOMES = '202304' THEN v.VALOR ELSE 0 END), 0) AS "202304",
    NVL(SUM(CASE WHEN v.ANOMES = '202305' THEN v.VALOR ELSE 0 END), 0) AS "202305",
    NVL(SUM(CASE WHEN v.ANOMES = '202306' THEN v.VALOR ELSE 0 END), 0) AS "202306",
    NVL(SUM(CASE WHEN v.ANOMES = '202307' THEN v.VALOR ELSE 0 END), 0) AS "202307",
    NVL(SUM(CASE WHEN v.ANOMES = '202308' THEN v.VALOR ELSE 0 END), 0) AS "202308",
    NVL(SUM(CASE WHEN v.ANOMES = '202309' THEN v.VALOR ELSE 0 END), 0) AS "202309",
    NVL(SUM(CASE WHEN v.ANOMES = '202310' THEN v.VALOR ELSE 0 END), 0) AS "202310",
    NVL(SUM(CASE WHEN v.ANOMES = '202311' THEN v.VALOR ELSE 0 END), 0) AS "202311",
    NVL(SUM(CASE WHEN v.ANOMES = '202312' THEN v.VALOR ELSE 0 END), 0) AS "202312",
    NVL(SUM(CASE WHEN v.ANOMES = '202401' THEN v.VALOR ELSE 0 END), 0) AS "202401",
    NVL(SUM(CASE WHEN v.ANOMES = '202402' THEN v.VALOR ELSE 0 END), 0) AS "202402",
    NVL(SUM(CASE WHEN v.ANOMES = '202403' THEN v.VALOR ELSE 0 END), 0) AS "202403",
    NVL(SUM(CASE WHEN v.ANOMES = '202404' THEN v.VALOR ELSE 0 END), 0) AS "202404",
    NVL(SUM(CASE WHEN v.ANOMES = '202405' THEN v.VALOR ELSE 0 END), 0) AS "202405",
    NVL(SUM(CASE WHEN v.ANOMES = '202406' THEN v.VALOR ELSE 0 END), 0) AS "202406",
    NVL(SUM(CASE WHEN v.ANOMES = '202407' THEN v.VALOR ELSE 0 END), 0) AS "202407",
    NVL(SUM(CASE WHEN v.ANOMES = '202408' THEN v.VALOR ELSE 0 END), 0) AS "202408",
    NVL(SUM(CASE WHEN v.ANOMES = '202409' THEN v.VALOR ELSE 0 END), 0) AS "202409",
    NVL(SUM(CASE WHEN v.ANOMES = '202410' THEN v.VALOR ELSE 0 END), 0) AS "202410",
    NVL(SUM(CASE WHEN v.ANOMES = '202411' THEN v.VALOR ELSE 0 END), 0) AS "202411",
    NVL(SUM(CASE WHEN v.ANOMES = '202412' THEN v.VALOR ELSE 0 END), 0) AS "202412",
    NVL(SUM(CASE WHEN v.ANOMES = '202501' THEN v.VALOR ELSE 0 END), 0) AS "202501",
    NVL(SUM(CASE WHEN v.ANOMES = '202502' THEN v.VALOR ELSE 0 END), 0) AS "202502",
    NVL(SUM(CASE WHEN v.ANOMES = '202503' THEN v.VALOR ELSE 0 END), 0) AS "202503",
    NVL(SUM(CASE WHEN v.ANOMES = '202504' THEN v.VALOR ELSE 0 END), 0) AS "202504",
    NVL(SUM(CASE WHEN v.ANOMES = '202505' THEN v.VALOR ELSE 0 END), 0) AS "202505",
    NVL(SUM(CASE WHEN v.ANOMES = '202506' THEN v.VALOR ELSE 0 END), 0) AS "202506",
    NVL(SUM(CASE WHEN v.ANOMES = '202507' THEN v.VALOR ELSE 0 END), 0) AS "202507",
    NVL(SUM(CASE WHEN v.ANOMES = '202508' THEN v.VALOR ELSE 0 END), 0) AS "202508",
    NVL(SUM(CASE WHEN v.ANOMES = '202509' THEN v.VALOR ELSE 0 END), 0) AS "202509",
    NVL(SUM(CASE WHEN v.ANOMES = '202510' THEN v.VALOR ELSE 0 END), 0) AS "202510",
    NVL(SUM(CASE WHEN v.ANOMES = '202511' THEN v.VALOR ELSE 0 END), 0) AS "202511",
    NVL(SUM(CASE WHEN v.ANOMES = '202512' THEN v.VALOR ELSE 0 END), 0) AS "202512"
FROM 
    foprte f
LEFT OUTER JOIN FACTURAS.T_VENTAS_PRODUCCION v ON f.CODTERM = v.CODIGO
GROUP BY 
    f.CODTERM, f.NOMTERM
 
union all
	


SELECT 
    NVL(f.CODTERM, 'SIN CODIGO') AS CODPROD,
    NVL(RPAD(LTRIM(RTRIM(f.NOMTERM)), 50, '.') || ' ==> ' || f.CODTERM, 'SIN DESCRIPCION') AS NOMPROD,
    4 AS UBICACION, 
    'CUARENTENA' AS tipo, 
    NVL(SUM(CASE WHEN v.ANOMES = '202301' THEN v.VALOR ELSE 0 END), 0) AS "202301",
    NVL(SUM(CASE WHEN v.ANOMES = '202302' THEN v.VALOR ELSE 0 END), 0) AS "202302",
    NVL(SUM(CASE WHEN v.ANOMES = '202303' THEN v.VALOR ELSE 0 END), 0) AS "202303",
    NVL(SUM(CASE WHEN v.ANOMES = '202304' THEN v.VALOR ELSE 0 END), 0) AS "202304",
    NVL(SUM(CASE WHEN v.ANOMES = '202305' THEN v.VALOR ELSE 0 END), 0) AS "202305",
    NVL(SUM(CASE WHEN v.ANOMES = '202306' THEN v.VALOR ELSE 0 END), 0) AS "202306",
    NVL(SUM(CASE WHEN v.ANOMES = '202307' THEN v.VALOR ELSE 0 END), 0) AS "202307",
    NVL(SUM(CASE WHEN v.ANOMES = '202308' THEN v.VALOR ELSE 0 END), 0) AS "202308",
    NVL(SUM(CASE WHEN v.ANOMES = '202309' THEN v.VALOR ELSE 0 END), 0) AS "202309",
    NVL(SUM(CASE WHEN v.ANOMES = '202310' THEN v.VALOR ELSE 0 END), 0) AS "202310",
    NVL(SUM(CASE WHEN v.ANOMES = '202311' THEN v.VALOR ELSE 0 END), 0) AS "202311",
    NVL(SUM(CASE WHEN v.ANOMES = '202312' THEN v.VALOR ELSE 0 END), 0) AS "202312",
    NVL(SUM(CASE WHEN v.ANOMES = '202401' THEN v.VALOR ELSE 0 END), 0) AS "202401",
    NVL(SUM(CASE WHEN v.ANOMES = '202402' THEN v.VALOR ELSE 0 END), 0) AS "202402",
    NVL(SUM(CASE WHEN v.ANOMES = '202403' THEN v.VALOR ELSE 0 END), 0) AS "202403",
    NVL(SUM(CASE WHEN v.ANOMES = '202404' THEN v.VALOR ELSE 0 END), 0) AS "202404",
    NVL(SUM(CASE WHEN v.ANOMES = '202405' THEN v.VALOR ELSE 0 END), 0) AS "202405",
    NVL(SUM(CASE WHEN v.ANOMES = '202406' THEN v.VALOR ELSE 0 END), 0) AS "202406",
    NVL(SUM(CASE WHEN v.ANOMES = '202407' THEN v.VALOR ELSE 0 END), 0) AS "202407",
    NVL(SUM(CASE WHEN v.ANOMES = '202408' THEN v.VALOR ELSE 0 END), 0) AS "202408",
    NVL(SUM(CASE WHEN v.ANOMES = '202409' THEN v.VALOR ELSE 0 END), 0) AS "202409",
    NVL(SUM(CASE WHEN v.ANOMES = '202410' THEN v.VALOR ELSE 0 END), 0) AS "202410",
    NVL(SUM(CASE WHEN v.ANOMES = '202411' THEN v.VALOR ELSE 0 END), 0) AS "202411",
    NVL(SUM(CASE WHEN v.ANOMES = '202412' THEN v.VALOR ELSE 0 END), 0) AS "202412",
    NVL(SUM(CASE WHEN v.ANOMES = '202501' THEN v.VALOR ELSE 0 END), 0) AS "202501",
    NVL(SUM(CASE WHEN v.ANOMES = '202502' THEN v.VALOR ELSE 0 END), 0) AS "202502",
    NVL(SUM(CASE WHEN v.ANOMES = '202503' THEN v.VALOR ELSE 0 END), 0) AS "202503",
    NVL(SUM(CASE WHEN v.ANOMES = '202504' THEN v.VALOR ELSE 0 END), 0) AS "202504",
    NVL(SUM(CASE WHEN v.ANOMES = '202505' THEN v.VALOR ELSE 0 END), 0) AS "202505",
    NVL(SUM(CASE WHEN v.ANOMES = '202506' THEN v.VALOR ELSE 0 END), 0) AS "202506",
    NVL(SUM(CASE WHEN v.ANOMES = '202507' THEN v.VALOR ELSE 0 END), 0) AS "202507",
    NVL(SUM(CASE WHEN v.ANOMES = '202508' THEN v.VALOR ELSE 0 END), 0) AS "202508",
    NVL(SUM(CASE WHEN v.ANOMES = '202509' THEN v.VALOR ELSE 0 END), 0) AS "202509",
    NVL(SUM(CASE WHEN v.ANOMES = '202510' THEN v.VALOR ELSE 0 END), 0) AS "202510",
    NVL(SUM(CASE WHEN v.ANOMES = '202511' THEN v.VALOR ELSE 0 END), 0) AS "202511",
    NVL(SUM(CASE WHEN v.ANOMES = '202512' THEN v.VALOR ELSE 0 END), 0) AS "202512"
FROM 
    foprte f
FULL OUTER JOIN FACTURAS.T_CUARENTENA_PRODUCCION v ON f.CODTERM =v.CODIGO
GROUP BY 
    f.CODTERM, f.NOMTERM, v.CODIGO
 union all
 SELECT 
    NVL(f.CODTERM, 'SIN CODIGO') AS CODPROD,
    NVL(RPAD(LTRIM(RTRIM(f.NOMTERM)), 50, '.') || ' ==> ' || f.CODTERM, 'SIN DESCRIPCION') AS NOMPROD,
    5 AS UBICACION, 
    'ENTREGAS' AS tipo, 
    NVL(SUM(CASE WHEN v.ANOMES = '202301' THEN v.VALOR ELSE 0 END), 0) AS "202301",
    NVL(SUM(CASE WHEN v.ANOMES = '202302' THEN v.VALOR ELSE 0 END), 0) AS "202302",
    NVL(SUM(CASE WHEN v.ANOMES = '202303' THEN v.VALOR ELSE 0 END), 0) AS "202303",
    NVL(SUM(CASE WHEN v.ANOMES = '202304' THEN v.VALOR ELSE 0 END), 0) AS "202304",
    NVL(SUM(CASE WHEN v.ANOMES = '202305' THEN v.VALOR ELSE 0 END), 0) AS "202305",
    NVL(SUM(CASE WHEN v.ANOMES = '202306' THEN v.VALOR ELSE 0 END), 0) AS "202306",
    NVL(SUM(CASE WHEN v.ANOMES = '202307' THEN v.VALOR ELSE 0 END), 0) AS "202307",
    NVL(SUM(CASE WHEN v.ANOMES = '202308' THEN v.VALOR ELSE 0 END), 0) AS "202308",
    NVL(SUM(CASE WHEN v.ANOMES = '202309' THEN v.VALOR ELSE 0 END), 0) AS "202309",
    NVL(SUM(CASE WHEN v.ANOMES = '202310' THEN v.VALOR ELSE 0 END), 0) AS "202310",
    NVL(SUM(CASE WHEN v.ANOMES = '202311' THEN v.VALOR ELSE 0 END), 0) AS "202311",
    NVL(SUM(CASE WHEN v.ANOMES = '202312' THEN v.VALOR ELSE 0 END), 0) AS "202312",
    NVL(SUM(CASE WHEN v.ANOMES = '202401' THEN v.VALOR ELSE 0 END), 0) AS "202401",
    NVL(SUM(CASE WHEN v.ANOMES = '202402' THEN v.VALOR ELSE 0 END), 0) AS "202402",
    NVL(SUM(CASE WHEN v.ANOMES = '202403' THEN v.VALOR ELSE 0 END), 0) AS "202403",
    NVL(SUM(CASE WHEN v.ANOMES = '202404' THEN v.VALOR ELSE 0 END), 0) AS "202404",
    NVL(SUM(CASE WHEN v.ANOMES = '202405' THEN v.VALOR ELSE 0 END), 0) AS "202405",
    NVL(SUM(CASE WHEN v.ANOMES = '202406' THEN v.VALOR ELSE 0 END), 0) AS "202406",
    NVL(SUM(CASE WHEN v.ANOMES = '202407' THEN v.VALOR ELSE 0 END), 0) AS "202407",
    NVL(SUM(CASE WHEN v.ANOMES = '202408' THEN v.VALOR ELSE 0 END), 0) AS "202408",
    NVL(SUM(CASE WHEN v.ANOMES = '202409' THEN v.VALOR ELSE 0 END), 0) AS "202409",
    NVL(SUM(CASE WHEN v.ANOMES = '202410' THEN v.VALOR ELSE 0 END), 0) AS "202410",
    NVL(SUM(CASE WHEN v.ANOMES = '202411' THEN v.VALOR ELSE 0 END), 0) AS "202411",
    NVL(SUM(CASE WHEN v.ANOMES = '202412' THEN v.VALOR ELSE 0 END), 0) AS "202412",
    NVL(SUM(CASE WHEN v.ANOMES = '202501' THEN v.VALOR ELSE 0 END), 0) AS "202501",
    NVL(SUM(CASE WHEN v.ANOMES = '202502' THEN v.VALOR ELSE 0 END), 0) AS "202502",
    NVL(SUM(CASE WHEN v.ANOMES = '202503' THEN v.VALOR ELSE 0 END), 0) AS "202503",
    NVL(SUM(CASE WHEN v.ANOMES = '202504' THEN v.VALOR ELSE 0 END), 0) AS "202504",
    NVL(SUM(CASE WHEN v.ANOMES = '202505' THEN v.VALOR ELSE 0 END), 0) AS "202505",
    NVL(SUM(CASE WHEN v.ANOMES = '202506' THEN v.VALOR ELSE 0 END), 0) AS "202506",
    NVL(SUM(CASE WHEN v.ANOMES = '202507' THEN v.VALOR ELSE 0 END), 0) AS "202507",
    NVL(SUM(CASE WHEN v.ANOMES = '202508' THEN v.VALOR ELSE 0 END), 0) AS "202508",
    NVL(SUM(CASE WHEN v.ANOMES = '202509' THEN v.VALOR ELSE 0 END), 0) AS "202509",
    NVL(SUM(CASE WHEN v.ANOMES = '202510' THEN v.VALOR ELSE 0 END), 0) AS "202510",
    NVL(SUM(CASE WHEN v.ANOMES = '202511' THEN v.VALOR ELSE 0 END), 0) AS "202511",
    NVL(SUM(CASE WHEN v.ANOMES = '202512' THEN v.VALOR ELSE 0 END), 0) AS "202512"
FROM 
    foprte f
FULL OUTER JOIN FACTURAS.T_ENTREGAS_PRODUCCION v ON f.CODTERM = v.CODIGO
GROUP BY 

    f.CODTERM, f.NOMTERM, v.CODIGO
	union all
	SELECT 
    NVL(f.CODTERM, 'SIN CODIGO') AS CODPROD,
    NVL(RPAD(LTRIM(RTRIM(f.NOMTERM)), 50, '.') || ' ==> ' || f.CODTERM, 'SIN DESCRIPCION') AS NOMPROD,
    6 AS UBICACION, 
    'SALIDAS' AS tipo, 
    NVL(SUM(CASE WHEN v.ANOMES = '202301' THEN v.VALOR ELSE 0 END), 0) AS "202301",
    NVL(SUM(CASE WHEN v.ANOMES = '202302' THEN v.VALOR ELSE 0 END), 0) AS "202302",
    NVL(SUM(CASE WHEN v.ANOMES = '202303' THEN v.VALOR ELSE 0 END), 0) AS "202303",
    NVL(SUM(CASE WHEN v.ANOMES = '202304' THEN v.VALOR ELSE 0 END), 0) AS "202304",
    NVL(SUM(CASE WHEN v.ANOMES = '202305' THEN v.VALOR ELSE 0 END), 0) AS "202305",
    NVL(SUM(CASE WHEN v.ANOMES = '202306' THEN v.VALOR ELSE 0 END), 0) AS "202306",
    NVL(SUM(CASE WHEN v.ANOMES = '202307' THEN v.VALOR ELSE 0 END), 0) AS "202307",
    NVL(SUM(CASE WHEN v.ANOMES = '202308' THEN v.VALOR ELSE 0 END), 0) AS "202308",
    NVL(SUM(CASE WHEN v.ANOMES = '202309' THEN v.VALOR ELSE 0 END), 0) AS "202309",
    NVL(SUM(CASE WHEN v.ANOMES = '202310' THEN v.VALOR ELSE 0 END), 0) AS "202310",
    NVL(SUM(CASE WHEN v.ANOMES = '202311' THEN v.VALOR ELSE 0 END), 0) AS "202311",
    NVL(SUM(CASE WHEN v.ANOMES = '202312' THEN v.VALOR ELSE 0 END), 0) AS "202312",
    NVL(SUM(CASE WHEN v.ANOMES = '202401' THEN v.VALOR ELSE 0 END), 0) AS "202401",
    NVL(SUM(CASE WHEN v.ANOMES = '202402' THEN v.VALOR ELSE 0 END), 0) AS "202402",
    NVL(SUM(CASE WHEN v.ANOMES = '202403' THEN v.VALOR ELSE 0 END), 0) AS "202403",
    NVL(SUM(CASE WHEN v.ANOMES = '202404' THEN v.VALOR ELSE 0 END), 0) AS "202404",
    NVL(SUM(CASE WHEN v.ANOMES = '202405' THEN v.VALOR ELSE 0 END), 0) AS "202405",
    NVL(SUM(CASE WHEN v.ANOMES = '202406' THEN v.VALOR ELSE 0 END), 0) AS "202406",
    NVL(SUM(CASE WHEN v.ANOMES = '202407' THEN v.VALOR ELSE 0 END), 0) AS "202407",
    NVL(SUM(CASE WHEN v.ANOMES = '202408' THEN v.VALOR ELSE 0 END), 0) AS "202408",
    NVL(SUM(CASE WHEN v.ANOMES = '202409' THEN v.VALOR ELSE 0 END), 0) AS "202409",
    NVL(SUM(CASE WHEN v.ANOMES = '202410' THEN v.VALOR ELSE 0 END), 0) AS "202410",
    NVL(SUM(CASE WHEN v.ANOMES = '202411' THEN v.VALOR ELSE 0 END), 0) AS "202411",
    NVL(SUM(CASE WHEN v.ANOMES = '202412' THEN v.VALOR ELSE 0 END), 0) AS "202412",
    NVL(SUM(CASE WHEN v.ANOMES = '202501' THEN v.VALOR ELSE 0 END), 0) AS "202501",
    NVL(SUM(CASE WHEN v.ANOMES = '202502' THEN v.VALOR ELSE 0 END), 0) AS "202502",
    NVL(SUM(CASE WHEN v.ANOMES = '202503' THEN v.VALOR ELSE 0 END), 0) AS "202503",
    NVL(SUM(CASE WHEN v.ANOMES = '202504' THEN v.VALOR ELSE 0 END), 0) AS "202504",
    NVL(SUM(CASE WHEN v.ANOMES = '202505' THEN v.VALOR ELSE 0 END), 0) AS "202505",
    NVL(SUM(CASE WHEN v.ANOMES = '202506' THEN v.VALOR ELSE 0 END), 0) AS "202506",
    NVL(SUM(CASE WHEN v.ANOMES = '202507' THEN v.VALOR ELSE 0 END), 0) AS "202507",
    NVL(SUM(CASE WHEN v.ANOMES = '202508' THEN v.VALOR ELSE 0 END), 0) AS "202508",
    NVL(SUM(CASE WHEN v.ANOMES = '202509' THEN v.VALOR ELSE 0 END), 0) AS "202509",
    NVL(SUM(CASE WHEN v.ANOMES = '202510' THEN v.VALOR ELSE 0 END), 0) AS "202510",
    NVL(SUM(CASE WHEN v.ANOMES = '202511' THEN v.VALOR ELSE 0 END), 0) AS "202511",
    NVL(SUM(CASE WHEN v.ANOMES = '202512' THEN v.VALOR ELSE 0 END), 0) AS "202512"
FROM 
    foprte f
FULL OUTER JOIN FACTURAS.T_SALIDAS_PRODUCCION v ON f.CODTERM = v.CODIGO
GROUP BY 
    f.CODTERM, f.NOMTERM,v.CODIGO


union all
SELECT 
    NVL(f.CODTERM, 'SIN CODIGO') AS CODPROD,
    NVL(RPAD(LTRIM(RTRIM(f.NOMTERM)), 50, '.') || ' ==> ' || f.CODTERM, 'SIN DESCRIPCION') AS NOMPROD,
    7 AS UBICACION, 
    'PPTO VENTAS' AS tipo, 
 NVL(SUM(CASE WHEN v.ANOMES = '202301' THEN v.VALOR ELSE 0 END), 0) AS "202301",
    NVL(SUM(CASE WHEN v.ANOMES = '202302' THEN v.VALOR ELSE 0 END), 0) AS "202302",
    NVL(SUM(CASE WHEN v.ANOMES = '202303' THEN v.VALOR ELSE 0 END), 0) AS "202303",
    NVL(SUM(CASE WHEN v.ANOMES = '202304' THEN v.VALOR ELSE 0 END), 0) AS "202304",
    NVL(SUM(CASE WHEN v.ANOMES = '202305' THEN v.VALOR ELSE 0 END), 0) AS "202305",
    NVL(SUM(CASE WHEN v.ANOMES = '202306' THEN v.VALOR ELSE 0 END), 0) AS "202306",
    NVL(SUM(CASE WHEN v.ANOMES = '202307' THEN v.VALOR ELSE 0 END), 0) AS "202307",
    NVL(SUM(CASE WHEN v.ANOMES = '202308' THEN v.VALOR ELSE 0 END), 0) AS "202308",
    NVL(SUM(CASE WHEN v.ANOMES = '202309' THEN v.VALOR ELSE 0 END), 0) AS "202309",
    NVL(SUM(CASE WHEN v.ANOMES = '202310' THEN v.VALOR ELSE 0 END), 0) AS "202310",
    NVL(SUM(CASE WHEN v.ANOMES = '202311' THEN v.VALOR ELSE 0 END), 0) AS "202311",
    NVL(SUM(CASE WHEN v.ANOMES = '202312' THEN v.VALOR ELSE 0 END), 0) AS "202312",
    NVL(SUM(CASE WHEN v.ANOMES = '202401' THEN v.VALOR ELSE 0 END), 0) AS "202401",
    NVL(SUM(CASE WHEN v.ANOMES = '202402' THEN v.VALOR ELSE 0 END), 0) AS "202402",
    NVL(SUM(CASE WHEN v.ANOMES = '202403' THEN v.VALOR ELSE 0 END), 0) AS "202403",
    NVL(SUM(CASE WHEN v.ANOMES = '202404' THEN v.VALOR ELSE 0 END), 0) AS "202404",
    NVL(SUM(CASE WHEN v.ANOMES = '202405' THEN v.VALOR ELSE 0 END), 0) AS "202405",
    NVL(SUM(CASE WHEN v.ANOMES = '202406' THEN v.VALOR ELSE 0 END), 0) AS "202406",
    NVL(SUM(CASE WHEN v.ANOMES = '202407' THEN v.VALOR ELSE 0 END), 0) AS "202407",
    NVL(SUM(CASE WHEN v.ANOMES = '202408' THEN v.VALOR ELSE 0 END), 0) AS "202408",
    NVL(SUM(CASE WHEN v.ANOMES = '202409' THEN v.VALOR ELSE 0 END), 0) AS "202409",
    NVL(SUM(CASE WHEN v.ANOMES = '202410' THEN v.VALOR ELSE 0 END), 0) AS "202410",
    NVL(SUM(CASE WHEN v.ANOMES = '202411' THEN v.VALOR ELSE 0 END), 0) AS "202411",
    NVL(SUM(CASE WHEN v.ANOMES = '202412' THEN v.VALOR ELSE 0 END), 0) AS "202412",
    NVL(SUM(CASE WHEN v.ANOMES = '202501' THEN v.VALOR ELSE 0 END), 0) AS "202501",
    NVL(SUM(CASE WHEN v.ANOMES = '202502' THEN v.VALOR ELSE 0 END), 0) AS "202502",
    NVL(SUM(CASE WHEN v.ANOMES = '202503' THEN v.VALOR ELSE 0 END), 0) AS "202503",
    NVL(SUM(CASE WHEN v.ANOMES = '202504' THEN v.VALOR ELSE 0 END), 0) AS "202504",
    NVL(SUM(CASE WHEN v.ANOMES = '202505' THEN v.VALOR ELSE 0 END), 0) AS "202505",
    NVL(SUM(CASE WHEN v.ANOMES = '202506' THEN v.VALOR ELSE 0 END), 0) AS "202506",
    NVL(SUM(CASE WHEN v.ANOMES = '202507' THEN v.VALOR ELSE 0 END), 0) AS "202507",
    NVL(SUM(CASE WHEN v.ANOMES = '202508' THEN v.VALOR ELSE 0 END), 0) AS "202508",
    NVL(SUM(CASE WHEN v.ANOMES = '202509' THEN v.VALOR ELSE 0 END), 0) AS "202509",
    NVL(SUM(CASE WHEN v.ANOMES = '202510' THEN v.VALOR ELSE 0 END), 0) AS "202510",
    NVL(SUM(CASE WHEN v.ANOMES = '202511' THEN v.VALOR ELSE 0 END), 0) AS "202511",
    NVL(SUM(CASE WHEN v.ANOMES = '202512' THEN v.VALOR ELSE 0 END), 0) AS "202512"
FROM 
    foprte f
FULL OUTER JOIN FACTURAS.T_VENTASMMPPTO_PRODUCCION v ON f.CODTERM = v.CODIGO
GROUP BY 
    f.CODTERM, f.NOMTERM, v.CODIGO
union all	
	
	SELECT 
    NVL(f.CODTERM, 'SIN CODIGO') AS CODPROD,
    NVL(RPAD(LTRIM(RTRIM(f.NOMTERM)), 50, '.') || ' ==> ' || f.CODTERM, 'SIN DESCRIPCION') AS NOMPROD,
    8 AS UBICACION, 
    'STOCKREAL' AS tipo, 
 NVL(SUM(CASE WHEN v.ANOMES = '202301' THEN v.VALOR ELSE 0 END), 0) AS "202301",
    NVL(SUM(CASE WHEN v.ANOMES = '202302' THEN v.VALOR ELSE 0 END), 0) AS "202302",
    NVL(SUM(CASE WHEN v.ANOMES = '202303' THEN v.VALOR ELSE 0 END), 0) AS "202303",
    NVL(SUM(CASE WHEN v.ANOMES = '202304' THEN v.VALOR ELSE 0 END), 0) AS "202304",
    NVL(SUM(CASE WHEN v.ANOMES = '202305' THEN v.VALOR ELSE 0 END), 0) AS "202305",
    NVL(SUM(CASE WHEN v.ANOMES = '202306' THEN v.VALOR ELSE 0 END), 0) AS "202306",
    NVL(SUM(CASE WHEN v.ANOMES = '202307' THEN v.VALOR ELSE 0 END), 0) AS "202307",
    NVL(SUM(CASE WHEN v.ANOMES = '202308' THEN v.VALOR ELSE 0 END), 0) AS "202308",
    NVL(SUM(CASE WHEN v.ANOMES = '202309' THEN v.VALOR ELSE 0 END), 0) AS "202309",
    NVL(SUM(CASE WHEN v.ANOMES = '202310' THEN v.VALOR ELSE 0 END), 0) AS "202310",
    NVL(SUM(CASE WHEN v.ANOMES = '202311' THEN v.VALOR ELSE 0 END), 0) AS "202311",
    NVL(SUM(CASE WHEN v.ANOMES = '202312' THEN v.VALOR ELSE 0 END), 0) AS "202312",
    NVL(SUM(CASE WHEN v.ANOMES = '202401' THEN v.VALOR ELSE 0 END), 0) AS "202401",
    NVL(SUM(CASE WHEN v.ANOMES = '202402' THEN v.VALOR ELSE 0 END), 0) AS "202402",
    NVL(SUM(CASE WHEN v.ANOMES = '202403' THEN v.VALOR ELSE 0 END), 0) AS "202403",
    NVL(SUM(CASE WHEN v.ANOMES = '202404' THEN v.VALOR ELSE 0 END), 0) AS "202404",
    NVL(SUM(CASE WHEN v.ANOMES = '202405' THEN v.VALOR ELSE 0 END), 0) AS "202405",
    NVL(SUM(CASE WHEN v.ANOMES = '202406' THEN v.VALOR ELSE 0 END), 0) AS "202406",
    NVL(SUM(CASE WHEN v.ANOMES = '202407' THEN v.VALOR ELSE 0 END), 0) AS "202407",
    NVL(SUM(CASE WHEN v.ANOMES = '202408' THEN v.VALOR ELSE 0 END), 0) AS "202408",
    NVL(SUM(CASE WHEN v.ANOMES = '202409' THEN v.VALOR ELSE 0 END), 0) AS "202409",
    NVL(SUM(CASE WHEN v.ANOMES = '202410' THEN v.VALOR ELSE 0 END), 0) AS "202410",
    NVL(SUM(CASE WHEN v.ANOMES = '202411' THEN v.VALOR ELSE 0 END), 0) AS "202411",
    NVL(SUM(CASE WHEN v.ANOMES = '202412' THEN v.VALOR ELSE 0 END), 0) AS "202412",
    NVL(SUM(CASE WHEN v.ANOMES = '202501' THEN v.VALOR ELSE 0 END), 0) AS "202501",
    NVL(SUM(CASE WHEN v.ANOMES = '202502' THEN v.VALOR ELSE 0 END), 0) AS "202502",
    NVL(SUM(CASE WHEN v.ANOMES = '202503' THEN v.VALOR ELSE 0 END), 0) AS "202503",
    NVL(SUM(CASE WHEN v.ANOMES = '202504' THEN v.VALOR ELSE 0 END), 0) AS "202504",
    NVL(SUM(CASE WHEN v.ANOMES = '202505' THEN v.VALOR ELSE 0 END), 0) AS "202505",
    NVL(SUM(CASE WHEN v.ANOMES = '202506' THEN v.VALOR ELSE 0 END), 0) AS "202506",
    NVL(SUM(CASE WHEN v.ANOMES = '202507' THEN v.VALOR ELSE 0 END), 0) AS "202507",
    NVL(SUM(CASE WHEN v.ANOMES = '202508' THEN v.VALOR ELSE 0 END), 0) AS "202508",
    NVL(SUM(CASE WHEN v.ANOMES = '202509' THEN v.VALOR ELSE 0 END), 0) AS "202509",
    NVL(SUM(CASE WHEN v.ANOMES = '202510' THEN v.VALOR ELSE 0 END), 0) AS "202510",
    NVL(SUM(CASE WHEN v.ANOMES = '202511' THEN v.VALOR ELSE 0 END), 0) AS "202511",
    NVL(SUM(CASE WHEN v.ANOMES = '202512' THEN v.VALOR ELSE 0 END), 0) AS "202512"
FROM 
    foprte f
FULL OUTER JOIN FACTURAS.T_STOCKREAL_PRODUCCION v ON f.CODTERM = v.CODIGO
GROUP BY 
    f.CODTERM, f.NOMTERM, v.CODIGO
    order by  CODPROD, NOMPROD, ubicacion,tipo 
	
 